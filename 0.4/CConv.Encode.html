<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="next" href="CConv.Decode.html">
<link rel="Up" href="CConv.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="CConv" rel="Chapter" href="CConv.html">
<link title="CConvBencode" rel="Chapter" href="CConvBencode.html">
<link title="CConvSexp" rel="Chapter" href="CConvSexp.html">
<link title="CConvYojson" rel="Chapter" href="CConvYojson.html">
<link title="CConvPSexp" rel="Chapter" href="CConvPSexp.html"><link title="Composite Types" rel="Section" href="#6_CompositeTypes">
<title>CConv.Encode</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="CConv.html" title="CConv">Up</a>
&nbsp;<a class="post" href="CConv.Decode.html" title="CConv.Decode">Next</a>
</div>
<h1>Module <a href="type_CConv.Encode.html">CConv.Encode</a></h1>

<pre><span id="MODULEEncode"><span class="keyword">module</span> Encode</span>: <code class="code">sig</code> <a href="CConv.Encode.html">..</a> <code class="code">end</code></pre><hr width="100%">

<pre><code><span id="TYPEoutput"><span class="keyword">type</span> <code class="type">'a</code> output</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.unit">unit</span>&nbsp;: <code class="type">'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.bool">bool</span>&nbsp;: <code class="type">bool -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.float">float</span>&nbsp;: <code class="type">float -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.char">char</span>&nbsp;: <code class="type">char -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.int">int</span>&nbsp;: <code class="type">int -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.nativeint">nativeint</span>&nbsp;: <code class="type">nativeint -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.int32">int32</span>&nbsp;: <code class="type">int32 -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.int64">int64</span>&nbsp;: <code class="type">int64 -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.string">string</span>&nbsp;: <code class="type">string -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.list">list</span>&nbsp;: <code class="type">'a list -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.option">option</span>&nbsp;: <code class="type">'a option -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.record">record</span>&nbsp;: <code class="type">(string * 'a) list -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.tuple">tuple</span>&nbsp;: <code class="type">'a list -> 'a</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELToutput.sum">sum</span>&nbsp;: <code class="type">string -> 'a list -> 'a</code>;</code></td>

</tr></table>
}



<pre><span id="VALstring_target"><span class="keyword">val</span> string_target</span> : <code class="type">string <a href="CConv.Encode.html#TYPEoutput">output</a></code></pre><div class="info ">
<div class="info-desc">
<p>Print values. Caution, inefficient! Should be used for debugging only</p>
</div>
</div>

<pre><code><span id="TYPEencoder"><span class="keyword">type</span> <code class="type">'src</code> encoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTencoder.emit">emit</span>&nbsp;: <code class="type">'into. 'into <a href="CConv.Encode.html#TYPEoutput">output</a> -> 'src -> 'into</code>;</code></td>

</tr></table>
}

<div class="info ">
<div class="info-desc">
<p>A way to encode values of type <code class="code">'src</code> into any serialization format</p>
</div>
</div>


<pre><span id="VALunit"><span class="keyword">val</span> unit</span> : <code class="type">unit <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALbool"><span class="keyword">val</span> bool</span> : <code class="type">bool <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALfloat"><span class="keyword">val</span> float</span> : <code class="type">float <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALchar"><span class="keyword">val</span> char</span> : <code class="type">char <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALint"><span class="keyword">val</span> int</span> : <code class="type">int <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALnativeint"><span class="keyword">val</span> nativeint</span> : <code class="type">nativeint <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALint32"><span class="keyword">val</span> int32</span> : <code class="type">int32 <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALint64"><span class="keyword">val</span> int64</span> : <code class="type">int64 <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALstring"><span class="keyword">val</span> string</span> : <code class="type">string <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALlist"><span class="keyword">val</span> list</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a list <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALoption"><span class="keyword">val</span> option</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a option <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALmap"><span class="keyword">val</span> map</span> : <code class="type">('a -> 'b) -> 'b <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALarray"><span class="keyword">val</span> array</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a array <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALsequence"><span class="keyword">val</span> sequence</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a <a href="CConv.html#TYPEsequence">CConv.sequence</a> <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><h7 id="6_CompositeTypes">Composite Types</h7>
<pre><span id="VALapply"><span class="keyword">val</span> apply</span> : <code class="type">'into <a href="CConv.Encode.html#TYPEoutput">output</a> -> 'src <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'src -> 'into</code></pre><div class="info ">
<div class="info-desc">
<p>Helper to apply an encoder to a value</p>
</div>
</div>

<pre><code><span id="TYPErecord_encoder"><span class="keyword">type</span> <code class="type">'r</code> record_encoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTrecord_encoder.record_emit">record_emit</span>&nbsp;: <code class="type">'into. 'into <a href="CConv.Encode.html#TYPEoutput">output</a> -> 'r -> (string * 'into) list</code>;</code></td>

</tr></table>
}



<pre><span id="VALrecord"><span class="keyword">val</span> record</span> : <code class="type">'r <a href="CConv.Encode.html#TYPErecord_encoder">record_encoder</a> -> 'r <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Encode a record, using the polymorphic record <a href="CConv.Encode.html#TYPErecord_encoder"><code class="code">CConv.Encode.record_encoder</code></a> to
      generate an association list</p>
</div>
</div>

<pre><span id="VALrecord_fix"><span class="keyword">val</span> record_fix</span> : <code class="type">('r <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'r <a href="CConv.Encode.html#TYPErecord_encoder">record_encoder</a>) -><br>       'r <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fixpoint on record definition</p>
</div>
</div>
<p>Example:</p>
<pre class="codepre"><code class="code"> type point = {x:int; y:int; c:string};;
   let enc_point = record
     {record_emit=fun into {x;y;c} -&gt;
        [ "x", into.int x
        ; "y", into.int y
        ; "c", into.string c
        ]
    } ;;
  </code></pre>
<pre><code><span id="TYPEtuple_encoder"><span class="keyword">type</span> <code class="type">'t</code> tuple_encoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtuple_encoder.tuple_emit">tuple_emit</span>&nbsp;: <code class="type">'into. 'into <a href="CConv.Encode.html#TYPEoutput">output</a> -> 't -> 'into list</code>;</code></td>

</tr></table>
}



<pre><span id="VALtuple"><span class="keyword">val</span> tuple</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEtuple_encoder">tuple_encoder</a> -> 'a <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>General encoding of tuples (returns a list of values)</p>
</div>
</div>

<pre><span id="VALpair"><span class="keyword">val</span> pair</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'b <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> ('a * 'b) <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALtriple"><span class="keyword">val</span> triple</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'b <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'c <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> ('a * 'b * 'c) <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALquad"><span class="keyword">val</span> quad</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'b <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'c <a href="CConv.Encode.html#TYPEencoder">encoder</a> -><br>       'd <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> ('a * 'b * 'c * 'd) <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><code><span id="TYPEsum_encoder"><span class="keyword">type</span> <code class="type">'s</code> sum_encoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsum_encoder.sum_emit">sum_emit</span>&nbsp;: <code class="type">'into. 'into <a href="CConv.Encode.html#TYPEoutput">output</a> -> 's -> string * 'into list</code>;</code></td>

</tr></table>
}



<pre><span id="VALsum"><span class="keyword">val</span> sum</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEsum_encoder">sum_encoder</a> -> 'a <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre>
<pre><span id="VALsum0"><span class="keyword">val</span> sum0</span> : <code class="type">('a -> string) -> 'a <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Constant sums, only put the name</p>
</div>
</div>

<pre><span id="VALsum_fix"><span class="keyword">val</span> sum_fix</span> : <code class="type">('a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a <a href="CConv.Encode.html#TYPEsum_encoder">sum_encoder</a>) -><br>       'a <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Fixpoint on sum types</p>
</div>
</div>
<p>Example:</p>
<pre class="codepre"><code class="code"> type tree = Empty | Leaf of int | Node of tree * tree;;
  let encode_tree = sum_fix
    (fun self -&gt; {sum_emit=fun into x -&gt; match x with
      | Empty -&gt; "empty", []
      | Leaf i -&gt; "leaf", [int.emit into i]
      | Node (l,r) -&gt; "node", [self.emit into l; self.emit into r]
    });;
  </code></pre>
<pre><span id="VALoption"><span class="keyword">val</span> option</span> : <code class="type">'a <a href="CConv.Encode.html#TYPEencoder">encoder</a> -> 'a option <a href="CConv.Encode.html#TYPEencoder">encoder</a></code></pre></body></html>