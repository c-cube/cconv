<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="CConv.Encode.html">
<link rel="Up" href="CConv.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="CConv" rel="Chapter" href="CConv.html">
<link title="CConvBencode" rel="Chapter" href="CConvBencode.html">
<link title="CConvSexp" rel="Chapter" href="CConvSexp.html">
<link title="CConvYojson" rel="Chapter" href="CConvYojson.html">
<link title="CConvPSexp" rel="Chapter" href="CConvPSexp.html"><link title="Decoder Combinators" rel="Section" href="#6_DecoderCombinators">
<title>CConv.Decode</title>
</head>
<body>
<div class="navbar"><a class="pre" href="CConv.Encode.html" title="CConv.Encode">Previous</a>
&nbsp;<a class="up" href="CConv.html" title="CConv">Up</a>
&nbsp;</div>
<h1>Module <a href="type_CConv.Decode.html">CConv.Decode</a></h1>

<pre><span id="MODULEDecode"><span class="keyword">module</span> Decode</span>: <code class="code">sig</code> <a href="CConv.Decode.html">..</a> <code class="code">end</code></pre><div class="info module top">
<div class="info-desc">
<h3 id="2_Decode">Decode</h3>
<p>A 'a decodee describes a way to traverse a value of some type representing
a serialization format such as JSON or B-encode</p>
</div>
</div>
<hr width="100%">

<pre><code><span id="TYPEsource"><span class="keyword">type</span> <code class="type">'src</code> source</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsource.emit">emit</span>&nbsp;: <code class="type">'a. ('src, 'a) <a href="CConv.Decode.html#TYPEinner_decoder">inner_decoder</a> -> 'src -> 'a</code>;</code></td>

</tr></table>
}

<div class="info ">
<div class="info-desc">
<p>Decode a value of type 'src</p>
</div>
</div>


<pre><code><span id="TYPEinner_decoder"><span class="keyword">type</span> <code class="type">('src, 'into)</code> inner_decoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_unit">accept_unit</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> unit -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_bool">accept_bool</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> bool -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_float">accept_float</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> float -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_int">accept_int</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> int -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_int32">accept_int32</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> int32 -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_int64">accept_int64</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> int64 -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_nativeint">accept_nativeint</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> nativeint -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_char">accept_char</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> char -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_string">accept_string</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> string -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_list">accept_list</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_option">accept_option</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src option -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_record">accept_record</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> (string * 'src) list -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_tuple">accept_tuple</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'into</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTinner_decoder.accept_sum">accept_sum</span>&nbsp;: <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> string -> 'src list -> 'into</code>;</code></td>

</tr></table>
}

<div class="info ">
<div class="info-desc">
<p>Decode a value of type 'src into a type 'into.</p>
</div>
</div>


<pre><code><span id="TYPEdecoder"><span class="keyword">type</span> <code class="type">'into</code> decoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdecoder.dec">dec</span>&nbsp;: <code class="type">'src. ('src, 'into) <a href="CConv.Decode.html#TYPEinner_decoder">inner_decoder</a></code>;</code></td>

</tr></table>
}



<pre><span id="VALapply"><span class="keyword">val</span> apply</span> : <code class="type">'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'src -> 'into</code></pre><div class="info ">
<div class="info-desc">
<p>Apply a decoder to a source</p>
</div>
</div>
<h7 id="6_DecoderCombinators">Decoder Combinators</h7>
<pre><span id="VALint"><span class="keyword">val</span> int</span> : <code class="type">int <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALchar"><span class="keyword">val</span> char</span> : <code class="type">char <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALint32"><span class="keyword">val</span> int32</span> : <code class="type">int32 <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALint64"><span class="keyword">val</span> int64</span> : <code class="type">int64 <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALnativeint"><span class="keyword">val</span> nativeint</span> : <code class="type">nativeint <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALfloat"><span class="keyword">val</span> float</span> : <code class="type">float <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALbool"><span class="keyword">val</span> bool</span> : <code class="type">bool <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALunit"><span class="keyword">val</span> unit</span> : <code class="type">unit <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALstring"><span class="keyword">val</span> string</span> : <code class="type">string <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALlist"><span class="keyword">val</span> list</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'a list <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALoption"><span class="keyword">val</span> option</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'a option <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALarray"><span class="keyword">val</span> array</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'a array <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALsequence"><span class="keyword">val</span> sequence</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'a <a href="CConv.html#TYPEsequence">CConv.sequence</a> <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALmap"><span class="keyword">val</span> map</span> : <code class="type">('a -> 'b) -> 'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'b <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Map the decoded value</p>
</div>
</div>

<pre><span id="VALarg0"><span class="keyword">val</span> arg0</span> : <code class="type">'src list -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Only accepts an empty list/tuple</p>
</div>
</div>

<pre><span id="VALarg1"><span class="keyword">val</span> arg1</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'a</code></pre><div class="info ">
<div class="info-desc">
<p>Only accepts a 1-element list/tuple</p>
</div>
</div>

<pre><span id="VALarg2"><span class="keyword">val</span> arg2</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'b <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'a * 'b</code></pre><div class="info ">
<div class="info-desc">
<p>Only accepts a 2-elements list/tuple</p>
</div>
</div>

<pre><span id="VALarg3"><span class="keyword">val</span> arg3</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'b <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'c <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'a * 'b * 'c</code></pre><div class="info ">
<div class="info-desc">
<p>Only accepts a 3-elements list/tuple</p>
</div>
</div>

<pre><span id="VALoption"><span class="keyword">val</span> option</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'a option <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Helper for options</p>
</div>
</div>

<pre><span id="VALpair"><span class="keyword">val</span> pair</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'b <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> ('a * 'b) <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALtriple"><span class="keyword">val</span> triple</span> : <code class="type">'a <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'b <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'c <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> ('a * 'b * 'c) <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><span id="VALrecord_get"><span class="keyword">val</span> record_get</span> : <code class="type">string -><br>       'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'src <a href="CConv.Decode.html#TYPEsource">source</a> -> (string * 'src) list -> 'into</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">record_get name dec l</code> is a helper for decoding records. It is
      given a list of fields <code class="code">l</code>, and searches <code class="code">name</code> through it.
      If <code class="code">name</code> is found with a value <code class="code">v</code>, <code class="code">dec.accept v</code> is called.
      Otherwise an error is raised</p>
</div>
</div>

<pre><span id="VALrecord_get_opt"><span class="keyword">val</span> record_get_opt</span> : <code class="type">string -><br>       'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -><br>       'src <a href="CConv.Decode.html#TYPEsource">source</a> -> (string * 'src) list -> 'into option</code></pre>
<pre><code><span id="TYPErecord_decoder"><span class="keyword">type</span> <code class="type">'into</code> record_decoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTrecord_decoder.record_accept">record_accept</span>&nbsp;: <code class="type">'src. 'src <a href="CConv.Decode.html#TYPEsource">source</a> -> (string * 'src) list -> 'into</code>;</code></td>

</tr></table>
}



<pre><span id="VALrecord"><span class="keyword">val</span> record</span> : <code class="type">'into <a href="CConv.Decode.html#TYPErecord_decoder">record_decoder</a> -> 'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Decoder for records. It will adapt itself to association tuples
      and lists.</p>
</div>
</div>

<pre><span id="VALrecord_fix"><span class="keyword">val</span> record_fix</span> : <code class="type">('into <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'into <a href="CConv.Decode.html#TYPErecord_decoder">record_decoder</a>) -><br>       'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><code><span id="TYPEsum_decoder"><span class="keyword">type</span> <code class="type">'into</code> sum_decoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsum_decoder.sum_accept">sum_accept</span>&nbsp;: <code class="type">'src. 'src <a href="CConv.Decode.html#TYPEsource">source</a> -> string -> 'src list -> 'into</code>;</code></td>

</tr></table>
}



<pre><span id="VALsum"><span class="keyword">val</span> sum</span> : <code class="type">'into <a href="CConv.Decode.html#TYPEsum_decoder">sum_decoder</a> -> 'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Decoder for sums. It will adapt itself to strings, lists
      and tuples</p>
</div>
</div>

<pre><span id="VALsum_fix"><span class="keyword">val</span> sum_fix</span> : <code class="type">('into <a href="CConv.Decode.html#TYPEdecoder">decoder</a> -> 'into <a href="CConv.Decode.html#TYPEsum_decoder">sum_decoder</a>) -><br>       'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre>
<pre><code><span id="TYPEtuple_decoder"><span class="keyword">type</span> <code class="type">'into</code> tuple_decoder</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtuple_decoder.tuple_accept">tuple_accept</span>&nbsp;: <code class="type">'src. 'src <a href="CConv.Decode.html#TYPEsource">source</a> -> 'src list -> 'into</code>;</code></td>

</tr></table>
}



<pre><span id="VALtuple"><span class="keyword">val</span> tuple</span> : <code class="type">'into <a href="CConv.Decode.html#TYPEtuple_decoder">tuple_decoder</a> -> 'into <a href="CConv.Decode.html#TYPEdecoder">decoder</a></code></pre><div class="info ">
<div class="info-desc">
<p>Tuple decoder</p>
</div>
</div>
<p>Examples:</p>
<pre class="codepre"><code class="code">  type mytuple = int * string * float list ;;

  let decode_mytuple = tuple {
    tuple_accept=fun src l -&gt; arg3 int int (list string) src l);
  };;

  (* OR, because triples are really easy: *)
  let decode_mytuple = triple int int (list string);;

  type point = { x:int;  y:int; color:string };;

  let decode_point = record ~expected:"point" {
    record_accept=(fun src l -&gt;
      let x = record_get "x" int src l in
      let y = record_get "y" int src l in
      let color = record_get "color" string src l in
      {x;y;color}
    );
  };;
  </code></pre></body></html>